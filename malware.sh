#!/bin/bash

# Definir la ruta donde se encuentran las reglas YARA compiladas
RULES_PATH="$HOME/Downloads/malware1/rules-compiled"

# Ruta de los archivos de malware en la misma carpeta
MALWARE_PATH="$HOME/Downloads/malware1"

# Verificar si las reglas de YARA existen
if [ ! -f "$RULES_PATH" ]; then
  echo "Las reglas YARA no se encuentran en la ruta especificada."
  exit 1
fi

# Verificar si YARA está instalado
if ! command -v yara &> /dev/null; then
  echo "YARA no está instalado. Por favor, instálalo primero."
  exit 1
fi

# Escanear cada archivo en la carpeta de malware usando las reglas compiladas
echo "Escaneando los archivos de malware..."
for malware_file in "$MALWARE_PATH"/*; do
  if [ -f "$malware_file" ]; then
    echo "Escaneando: $malware_file"
    yara "$RULES_PATH" "$malware_file"
  fi
done

echo "Escaneo completo."




