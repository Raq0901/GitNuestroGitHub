#!/bin/bash

# Carpeta que contiene los archivos de malware y el archivo de reglas
SCAN_DIR="$HOME/Downloads/malware1"
RULES_FILE="$SCAN_DIR/rules-compiled"

# Verifica que el directorio existe
if [ ! -d "$SCAN_DIR" ]; then
    echo "‚ùå El directorio '$SCAN_DIR' no existe."
    exit 1
fi

# Verifica que el archivo de reglas compiladas existe
if [ ! -f "$RULES_FILE" ]; then
    echo "‚ùå No se encontr√≥ el archivo de reglas: $RULES_FILE"
    exit 1
fi

echo "üîç Escaneando todos los archivos en: $SCAN_DIR"
echo "üìÑ Usando reglas compiladas: $RULES_FILE"
echo ""

# Ejecutar YARA recursivamente (-r) y mostrar strings que hacen match (-s)
output=$(yara -r -s "$RULES_FILE" "$SCAN_DIR" 2>&1)

# Mostrar resultados
if [ -z "$output" ]; then
    echo "‚úÖ No se detectaron coincidencias de malware."
else
    echo "‚ö†Ô∏è Coincidencias encontradas:"
    echo "$output"
fi



