#malware
#!/bin/bash

# Directorio de malware y reglas YARA compiladas
MALWARE_DIR="$HOME/Downloads/malware1"
RULES_FILE="$HOME/Desktop/rules/rules-compiled"

# Verificar si el directorio de malware existe
if [ ! -d "$MALWARE_DIR" ]; then
    echo "El directorio de malware '$MALWARE_DIR' no existe."
    exit 1
fi

# Verificar si el archivo de reglas compiladas existe
if [ ! -f "$RULES_FILE" ]; then
    echo "El archivo de reglas compiladas '$RULES_FILE' no existe."
    exit 1
fi

# Ejecutar YARA en el directorio de malware usando las reglas compiladas
echo "Analizando los archivos en '$MALWARE_DIR' con las reglas '$RULES_FILE'..."

yara -r "$RULES_FILE" "$MALWARE_DIR"

# Verificar si YARA encontró alguna coincidencia
if [ $? -eq 0 ]; then
    echo "¡No se encontraron coincidencias de malware!"
else
    echo "¡Se encontraron coincidencias de malware!"
fi
